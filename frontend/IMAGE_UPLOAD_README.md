# 图片上传交易记录功能

## 功能概述

用户可以通过上传交易记录的截图，系统会自动解析图片中的交易信息并添加到交易记录中。

## 功能特性

### 1. 图片上传
- 支持单个或多个图片文件上传
- 支持拖拽上传
- 文件大小限制：每个文件不超过10MB
- 文件类型限制：仅支持图片格式（jpg, png, gif等）

### 2. 自动解析
- 系统会自动解析图片中的交易信息
- 解析内容包括：股票代码、交易类型、数量、价格、日期等
- 解析成功后自动添加到交易记录列表

### 3. 用户界面
- 在"交易记录"标签页中添加了"图片上传"按钮
- 上传界面采用拖拽式设计，用户体验友好
- 显示已选择的文件列表和文件大小

## 使用方法

### 1. 进入交易记录页面
- 访问"我的投资组合"页面
- 点击"交易记录"标签页

### 2. 上传图片
- 点击"图片上传"按钮
- 在弹出的模态框中选择图片文件
- 可以拖拽文件到上传区域
- 支持多选文件

### 3. 确认上传
- 选择完文件后，点击"确定"按钮
- 系统会自动上传并解析图片
- 解析成功后会在交易记录中显示新的记录

## API接口

### 上传接口
```
POST /api/user_trade/{user_id}/upload_image
```

### 请求参数
- `user_id`: 用户ID
- `images[]`: 图片文件数组（multipart/form-data格式）

### 响应格式
```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "parsed_trades": [
      {
        "ts_code": "000001.SZ",
        "trade_type": "buy",
        "quantity": 100,
        "price": 10.50,
        "trade_date": "2023-11-15",
        "note": "图片解析的交易记录"
      }
    ]
  }
}
```

## 技术实现

### 前端实现
1. **文件选择**: 使用Ant Design的Upload组件
2. **文件验证**: 检查文件类型和大小
3. **批量上传**: 支持多个文件同时上传
4. **进度反馈**: 显示上传状态和结果

### 后端处理
1. **图片接收**: 接收multipart/form-data格式的文件
2. **图片解析**: 使用OCR技术解析图片中的文字
3. **信息提取**: 从解析的文字中提取交易信息
4. **数据保存**: 将解析的交易信息保存到数据库

## 注意事项

1. **图片质量**: 图片清晰度越高，解析准确率越高
2. **文件大小**: 单个文件不能超过10MB
3. **文件格式**: 仅支持常见图片格式
4. **网络环境**: 上传大文件时需要稳定的网络连接
5. **解析结果**: 建议用户检查解析结果，必要时手动修正

## 错误处理

### 常见错误
1. **文件格式错误**: 提示"只能上传图片文件！"
2. **文件过大**: 提示"图片大小不能超过10MB！"
3. **上传失败**: 提示"图片上传失败，请重试"
4. **解析失败**: 提示"图片解析失败，请检查图片质量"

### 错误恢复
- 上传失败时，用户可以重新选择文件
- 解析失败时，建议用户手动添加交易记录
- 网络中断时，可以重新上传

## 后续优化

1. **智能识别**: 提高图片解析的准确率
2. **批量处理**: 支持更多文件格式和更大的文件
3. **预览功能**: 上传前预览图片内容
4. **历史记录**: 显示上传历史和处理结果
5. **手动修正**: 允许用户手动修正解析结果 